<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>糖尿病管理 APP - 啟動中</title>
    <script src="https://cdn.jsdelivr.net/npm/fhirclient/build/fhir-client.js"></script>
</head>
<body>
    <div style="text-align: center; margin-top: 50px; font-family: 'Microsoft JhengHei', sans-serif;">
        <h2>正在連接衛福部醫療系統，請稍候...</h2>
        <p>正在進行安全驗證並導引至智慧決策支援介面</p>
        <div style="color: #666; font-size: 0.9em;">若畫面長時間無反應，請確認 Client ID 是否正確設定。</div>
    </div>

    <script>
        /**
         * 執行 SMART on FHIR 授權流程
         */
        FHIR.oauth2.authorize({
            // 1. ❗ 請填入您在衛福部 THAS 平台註冊後取得的 Client ID
            "client_id": "您的_CLIENT_ID", 

            // 2. 權限範圍：
            // launch: 必填，代表由醫療人員發起
            // openid / fhirUser: 獲取使用者登入資訊
            // patient/*.read: 讀取當前病患所有 FHIR 資源 (如 HbA1c 數據)
            "scope": "launch openid fhirUser patient/*.read",

            // 3. 授權成功後跳轉的目標檔案：
            // 請確保此網址與您在 THAS 平台後台註冊的 Redirect URI 完全一致
            "redirect_uri": "https://maizelin.github.io/Diabetes-l3/APP3.html",

            // 4. 指定衛福部的 FHIR Server 地址 (Audience/Issuer)
            "iss": "https://thas.mohw.gov.tw/v/r4/fhir"
        });
    </script>
</body>
</html>